<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ilich Vasquez - Professional Resume</title>
    <style>
        @media print {
            /* Print tuning: prevent bottom clipping and keep layout clean */
            @page { size: letter; margin: 0.4in; }
            html, body { background: #ffffff !important; }
            body { margin: 0; padding: 0; -webkit-print-color-adjust: exact; print-color-adjust: exact; }
            .no-print { display: none !important; }

            .container { box-shadow: none !important; }
            .header { padding: 28px !important; }
            .content { padding: 26px !important; }
            .section { margin-bottom: 22px !important; }
            .section-title { margin-bottom: 14px !important; padding-bottom: 6px !important; }
            .achievements li { margin-bottom: 6px !important; line-height: 1.55 !important; }
            .cert-grid { gap: 8px !important; }
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f5f5f5;
            padding: 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 850px;
            margin: 0 auto;
            background: white;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }

        .header {
            background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }

        .header h1 {
            font-size: 42px;
            font-weight: 700;
            margin-bottom: 10px;
            letter-spacing: 2px;
        }

        .tagline {
            margin-top: 6px;
            font-size: 14px;
            font-weight: 600;
            letter-spacing: 0.5px;
            opacity: 0.95;
        }

        .contact-info {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 15px;
            font-size: 14px;
            gap: 0; /* separators handle spacing */
        }

        .contact-info span {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 2px 0;
        }

        /* visual dividers like your tagline */
        .contact-info span:not(:last-child)::after {
            content: "|";
            opacity: 0.85;
            margin: 0 14px;
        }

        .contact-info span {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .content { padding: 40px; }

        .section { margin-bottom: 35px; }

        .section-title {
            font-size: 20px;
            font-weight: 700;
            color: #1e3a8a;
            border-bottom: 3px solid #3b82f6;
            padding-bottom: 8px;
            margin-bottom: 20px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .summary {
            font-size: 15px;
            color: #374151;
            line-height: 1.8;
            text-align: justify;
        }

        .skills-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        .skill-category h4 {
            color: #1e3a8a;
            font-size: 14px;
            margin-bottom: 5px;
            font-weight: 600;
        }

        .skill-category p {
            color: #6b7280;
            font-size: 13px;
            line-height: 1.6;
        }

        .job { margin-bottom: 30px; }

        .job-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 8px;
            flex-wrap: wrap;
        }

        .job-title {
            font-size: 16px;
            font-weight: 700;
            color: #1e3a8a;
        }

        .job-date {
            font-size: 13px;
            color: #6b7280;
            font-weight: 600;
        }

        .company {
            font-size: 14px;
            color: #374151;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .achievements {
            list-style: none;
            padding-left: 0;
        }

        .achievements li {
            padding-left: 20px;
            margin-bottom: 8px;
            position: relative;
            font-size: 13px;
            color: #4b5563;
            line-height: 1.7;
        }

        .achievements li:before {
            content: "‚ñ∏";
            position: absolute;
            left: 0;
            color: #3b82f6;
            font-weight: bold;
        }

        .achievements strong { color: #1e3a8a; }

        .education-item { margin-bottom: 12px; }

        .education-item h4 {
            font-size: 14px;
            color: #1e3a8a;
            margin-bottom: 3px;
        }

        .education-item p {
            font-size: 13px;
            color: #6b7280;
        }

        .cert-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }

        .cert-item {
            font-size: 13px;
            color: #4b5563;
            padding-left: 15px;
            position: relative;
        }

        .cert-item:before {
            content: "‚úì";
            position: absolute;
            left: 0;
            color: #3b82f6;
            font-weight: bold;
        }

        .languages, .technical {
            display: flex;
            gap: 30px;
            font-size: 14px;
        }

        .languages strong, .technical strong { color: #1e3a8a; }

        .button-container {
            position: fixed;
            top: 20px;
            right: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 1000;
        }

        .download-btn {
            background: #3b82f6;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: all 0.2s;
        }

        .download-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 8px rgba(0,0,0,0.15);
        }

        .download-btn:disabled {
            cursor: not-allowed;
            opacity: 0.7;
            transform: none;
        }

        .download-btn.edit { background: #059669; }
        .download-btn.edit:hover { background: #047857; }
        .download-btn.edit.active { background: #dc2626; }
        .download-btn.edit.active:hover { background: #b91c1c; }

        .download-btn.word { background: #2b5797; }
        .download-btn.word:hover { background: #1e3a6d; }

        .editable { outline: none; transition: background-color 0.2s; }

        .editable:focus {
            background-color: #fef3c7;
            padding: 2px;
            border-radius: 2px;
        }

        .edit-mode .editable {
            cursor: text;
            border: 1px dashed #d1d5db;
            padding: 2px;
            border-radius: 2px;
        }

        .edit-instructions {
            position: fixed;
            top: 150px;
            right: 20px;
            background: #10b981;
            color: white;
            padding: 15px 20px;
            border-radius: 5px;
            font-size: 13px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            display: none;
            max-width: 300px;
            z-index: 1000;
        }

        .edit-instructions.show { display: block; }

        /* Simple toast */
        .toast {
            position: fixed;
            left: 20px;
            bottom: 20px;
            max-width: 420px;
            padding: 12px 14px;
            border-radius: 6px;
            box-shadow: 0 6px 18px rgba(0,0,0,0.18);
            font-size: 13px;
            font-weight: 600;
            z-index: 2000;
            display: none;
            color: #fff;
        }
    
        /* Theme selector UI */
        .theme-select {
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
            background: #111827;
            color: #ffffff;
            padding: 10px 12px;
            border: 1px solid rgba(255,255,255,0.18);
            border-radius: 6px;
            font-size: 13px;
            font-weight: 700;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0,0,0,0.12);
        }
        .theme-select:focus { outline: 2px solid rgba(59,130,246,0.45); outline-offset: 2px; }

        /* Theme overrides (no changes to your content) */
        body[data-theme="classic"] { }

        body[data-theme="charcoal"] .header { background: linear-gradient(135deg, #111827 0%, #374151 100%); }
        body[data-theme="charcoal"] .section-title,
        body[data-theme="charcoal"] .job-title,
        body[data-theme="charcoal"] .skill-category h4,
        body[data-theme="charcoal"] .education-item h4,
        body[data-theme="charcoal"] .achievements strong,
        body[data-theme="charcoal"] .languages strong,
        body[data-theme="charcoal"] .technical strong { color: #111827; }
        body[data-theme="charcoal"] .section-title { border-bottom-color: #6b7280; }
        body[data-theme="charcoal"] .achievements li:before,
        body[data-theme="charcoal"] .cert-item:before { color: #6b7280; }
        body[data-theme="charcoal"] .download-btn { background: #6b7280; }

        body[data-theme="emerald"] .header { background: linear-gradient(135deg, #065f46 0%, #10b981 100%); }
        body[data-theme="emerald"] .section-title,
        body[data-theme="emerald"] .job-title,
        body[data-theme="emerald"] .skill-category h4,
        body[data-theme="emerald"] .education-item h4,
        body[data-theme="emerald"] .achievements strong,
        body[data-theme="emerald"] .languages strong,
        body[data-theme="emerald"] .technical strong { color: #065f46; }
        body[data-theme="emerald"] .section-title { border-bottom-color: #10b981; }
        body[data-theme="emerald"] .achievements li:before,
        body[data-theme="emerald"] .cert-item:before { color: #10b981; }
        body[data-theme="emerald"] .download-btn { background: #10b981; }

        body[data-theme="burgundy"] .header { background: linear-gradient(135deg, #7f1d1d 0%, #ef4444 100%); }
        body[data-theme="burgundy"] .section-title,
        body[data-theme="burgundy"] .job-title,
        body[data-theme="burgundy"] .skill-category h4,
        body[data-theme="burgundy"] .education-item h4,
        body[data-theme="burgundy"] .achievements strong,
        body[data-theme="burgundy"] .languages strong,
        body[data-theme="burgundy"] .technical strong { color: #7f1d1d; }
        body[data-theme="burgundy"] .section-title { border-bottom-color: #ef4444; }
        body[data-theme="burgundy"] .achievements li:before,
        body[data-theme="burgundy"] .cert-item:before { color: #ef4444; }
        body[data-theme="burgundy"] .download-btn { background: #ef4444; }

        body[data-theme="slate"] .header { background: linear-gradient(135deg, #0f172a 0%, #64748b 100%); }
        body[data-theme="slate"] .section-title,
        body[data-theme="slate"] .job-title,
        body[data-theme="slate"] .skill-category h4,
        body[data-theme="slate"] .education-item h4,
        body[data-theme="slate"] .achievements strong,
        body[data-theme="slate"] .languages strong,
        body[data-theme="slate"] .technical strong { color: #0f172a; }
        body[data-theme="slate"] .section-title { border-bottom-color: #64748b; }
        body[data-theme="slate"] .achievements li:before,
        body[data-theme="slate"] .cert-item:before { color: #64748b; }
        body[data-theme="slate"] .download-btn { background: #64748b; }

    </style>
</head>
<body>
    <div class="button-container no-print">
        <select class="theme-select" id="themeSelect" aria-label="Theme selector" title="Theme">
            <option value="classic">Classic Blue</option>
            <option value="charcoal">Modern Charcoal</option>
            <option value="emerald">Emerald</option>
            <option value="burgundy">Burgundy</option>
            <option value="slate">Slate</option>
        </select>
        <button class="download-btn edit" id="editBtn">‚úèÔ∏è Edit Mode</button>
        <button class="download-btn" id="pdfBtn">üìÑ Download PDF</button>
        <button class="download-btn word" id="wordBtn">üìù Download Word</button>
    </div>

    <div class="edit-instructions no-print" id="editInstructions">
        <strong>‚úèÔ∏è Edit Mode Active</strong><br />
        Click on any text to edit it directly. Click "Edit Mode" again to save your changes.
    </div>

    <div class="toast no-print" id="toast"></div>

    <div class="container">
        <div class="header">
            <h1 class="editable">ILICH VASQUEZ</h1>
            <div class="tagline editable">Bilingual Operations Leader | Contact Center Operations | Quality & Compliance | Workforce Optimization</div>
            <div class="contact-info">
                <span class="editable">üìç Brooklyn, NY</span>
                <span class="editable">üìû 864-749-1054</span>
                <span class="editable">‚úâÔ∏è ilitchvasquez@gmail.com</span>
                <span class="editable">Authorized to work in the U.S. without sponsorship</span>
            </div>
        </div>

        <div class="content">
            <div class="section">
                <h2 class="section-title">Professional Summary</h2>
                <p class="summary editable">
                    Bilingual (English/Spanish) Operations Leader with 15+ years of progressive experience leading large-scale contact center operations across Latin America. Proven track record managing multi-country, multi-site teams and consistently exceeding KPIs/SLA targets through operational excellence, workforce optimization, quality governance, and cross-functional leadership. Recognized for building high-performing teams, driving audit-ready processes in regulated environments, and bridging corporate strategy with disciplined execution.
                </p>
            </div>

            <div class="section">
                <h2 class="section-title">Core Competencies</h2>
                <div class="skills-grid">
                    <div class="skill-category">
                        <h4>Operations Leadership</h4>
                        <p class="editable">Contact Center Operations ‚Ä¢ Multi-Site / Multi-Country Leadership ‚Ä¢ Process Optimization ‚Ä¢ Continuous Improvement</p>
                    </div>
                    <div class="skill-category">
                        <h4>Workforce & Performance</h4>
                        <p class="editable">Forecasting & Capacity Planning ‚Ä¢ Scheduling & Intraday Management ‚Ä¢ Adherence ‚Ä¢ Productivity & KPI Management</p>
                    </div>
                    <div class="skill-category">
                        <h4>Quality, Risk & Compliance</h4>
                        <p class="editable">Quality Assurance ‚Ä¢ Calibration & Coaching ‚Ä¢ Internal Controls ‚Ä¢ Audit Readiness ‚Ä¢ Regulated Operations</p>
                    </div>
                    <div class="skill-category">
                        <h4>Stakeholders & Execution</h4>
                        <p class="editable">Stakeholder Management ‚Ä¢ SLA / Service Performance ‚Ä¢ Change Management ‚Ä¢ Project Leadership ‚Ä¢ Executive Reporting ‚Ä¢ Budget Planning</p>
                    </div>
                    <div class="skill-category">
                        <h4>Talent & Culture</h4>
                        <p class="editable">Team Leadership ‚Ä¢ Training & Coaching ‚Ä¢ Performance Management ‚Ä¢ Engagement & Retention ‚Ä¢ Cross-Cultural Collaboration</p>
                    </div>
                    <div class="skill-category">
                        <h4>Data & Reporting</h4>
                        <p class="editable">Operational Dashboards ‚Ä¢ Root-Cause Analysis ‚Ä¢ Trend Reporting ‚Ä¢ Excel (Advanced) ‚Ä¢ Data-Driven Decision-Making</p>
                    </div>
                </div>
            </div>

            <div class="section">
                <h2 class="section-title">Professional Experience</h2>

                <!-- Most recent first (Reverse Chronological) -->

                <div class="job">
                    <div class="job-header">
                        <div class="job-title editable">Multi-Unit Operations Manager (Retail &amp; Services)</div>
                        <div class="job-date editable">01/2024 ‚Äì Present</div>
                    </div>
                    <div class="company editable">Family-Owned Retail Group | Brooklyn, NY</div>
                    <ul class="achievements">
                        <li class="editable">Led day-to-day operations across a multi-location portfolio, coordinating staffing, scheduling, customer experience, and vendor support to stabilize execution and service consistency</li>
                        <li class="editable"><strong>Improved operational efficiency by 15%</strong> by standardizing workflows (open/close routines, service flow, task prioritization) and reinforcing accountability</li>
                        <li class="editable"><strong>Reduced inventory discrepancies by 25%</strong> through inventory control procedures (cycle counts, receiving checks, and variance tracking)</li>
                        <li class="editable">Implemented basic operational controls (cash handling discipline, issue logging, simple SOPs) to reduce recurring errors and improve team reliability</li>
                    </ul>
                </div>

                <div class="job">
                    <div class="job-header">
                        <div class="job-title editable">Senior Manager, Regional Contact Center Operations</div>
                        <div class="job-date editable">11/2021 ‚Äì 10/2023</div>
                    </div>
                    <div class="company editable">Scotiabank | Santo Domingo, Dominican Republic</div>
                    <ul class="achievements">
                        <li class="editable"><strong>Consistently exceeded annual performance targets by 15-20%</strong>, achieving "Exceeds Expectations" rating in 100% of annual performance reviews during management tenure</li>
                        <li class="editable"><strong>Achieved 98%+ SLA compliance</strong> across all service metrics year-over-year while maintaining superior customer satisfaction scores</li>
                        <li class="editable">Directed contact center operations spanning <strong>3 regions and 10 countries</strong> with 200+ team members, ensuring adherence to regulatory requirements and internal control standards</li>
                        <li class="editable">Partnered with Workforce Management and senior leadership to develop staffing strategies that <strong>improved agent productivity by 18%</strong> through optimized forecasting and scheduling protocols</li>
                        <li class="editable">Led cross-functional initiatives that enhanced operational efficiency through technology upgrades and process improvements</li>
                        <li class="editable"><strong>Served as budget owner</strong> for the contact center, leading annual budgeting and financial planning for <strong>headcount, overtime, and vendor spend</strong>, including variance analysis and resource alignment to service targets</li>
                        <li class="editable"><strong>Led internal audit readiness and compliance</strong> by maintaining controls, documentation, and evidence; <strong>owned remediation action plans</strong> and closure tracking after audit findings to keep operations audit-ready</li>
                    </ul>
                </div>

                <div class="job">
                    <div class="job-header">
                        <div class="job-title editable">Operations &amp; Administration Manager</div>
                        <div class="job-date editable">11/2019 ‚Äì 10/2021</div>
                    </div>
                    <div class="company editable">Scotiabank | Santo Domingo, Dominican Republic</div>
                    <ul class="achievements">
                        <li class="editable"><strong>Achieved 97%+ schedule adherence</strong> through real-time workforce management and scheduling optimization that maximized productivity</li>
                        <li class="editable"><strong>Improved forecasting accuracy by 20%</strong>, resulting in better resource allocation and enhanced service level performance</li>
                        <li class="editable">Established accountability structures that increased team performance and operational effectiveness</li>
                        <li class="editable">Achieved <strong>100% audit compliance</strong> through comprehensive operational reporting and metrics tracking</li>
                        <li class="editable">Provided guidance that reduced escalations and improved first-call resolution rates</li>
                    </ul>
                </div>

                <div class="job">
                    <div class="job-header">
                        <div class="job-title editable">Assistant Manager, Quality Assurance &amp; Operations</div>
                        <div class="job-date editable">11/2014 ‚Äì 10/2016</div>
                    </div>
                    <div class="company editable">Scotiabank | Santo Domingo, Dominican Republic</div>
                    <ul class="achievements">
                        <li class="editable">Achieved strong quality assurance scores across all evaluation categories through consistent training and performance monitoring</li>
                        <li class="editable">Managed comprehensive workforce planning for 100+ agent contact center, improving operational efficiency and service delivery</li>
                        <li class="editable">Coordinated platform upgrades that <strong>reduced system downtime by 30%</strong></li>
                        <li class="editable">Created operational reporting frameworks enabling data-driven decisions that contributed to improved departmental performance</li>
                        <li class="editable"><strong>Supported budget planning and expense governance</strong> by tracking spend trends and staffing drivers to inform leadership decisions and resource allocation</li>
                        <li class="editable">Recognized with <strong>"Exceeds Expectations"</strong> performance rating for consistent delivery of operational excellence</li>
                    </ul>
                </div>

<div class="job">
                    <div class="job-header">
                        <div class="job-title editable">Sales &amp; Customer Service Team Leader</div>
                        <div class="job-date editable">10/2009 ‚Äì 10/2014</div>
                    </div>
                    <div class="company editable">Scotiabank | Santo Domingo, Dominican Republic</div>
                    <ul class="achievements">
                        <li class="editable"><strong>Consistently exceeded sales and service targets by 10-15%</strong> through effective team coaching and skill development</li>
                        <li class="editable"><strong>Achieved 90%+ customer satisfaction scores</strong> while maintaining quality standards in fast-paced environment</li>
                        <li class="editable">Managed front-line teams of <strong>15-25 customer service representatives</strong> balancing sales objectives with exceptional service delivery</li>
                        <li class="editable">Implemented effective engagement strategies and career development programs that improved team retention</li>
                        <li class="editable">Implemented sales techniques that improved conversion rates and overall team performance</li>
                        <li class="editable">Recognized for developing high-performing agents who advanced to leadership positions within the organization</li>
                    </ul>
                </div>
            </div>

            <div class="section">
                <h2 class="section-title">Education</h2>
                <div class="education-item">
                    <h4 class="editable">Business Administration</h4>
                    <p class="editable">Universidad Tecnol√≥gica de Santiago (UTESA) | Dominican Republic</p>
                    <p class="editable">Coursework toward Bachelor of Business Administration</p>
                </div>
            </div>

            <div class="section">
                <h2 class="section-title">Professional Expertise</h2>
                <div class="cert-grid">
                    <div class="cert-item editable">Workforce Management: Planning & Forecasting</div>
                    <div class="cert-item editable">Workforce Management: Intraday / Real-Time Management</div>
                    <div class="cert-item editable">Quality Assurance: Calibration, Coaching & Performance Improvement</div>
                    <div class="cert-item editable">Skills-Based Routing & Queue Strategy</div>
                    <div class="cert-item editable">Business Continuity Planning (BCP) & Operational Resilience</div>
                    <div class="cert-item editable">Budgeting & Financial Planning (Contact Center Operations)</div>
                    <div class="cert-item editable">Audit Readiness, Internal Controls & Compliance Governance</div>
                    <div class="cert-item editable">Microsoft Office Suite (Advanced)</div>
                </div>
            </div>

            <div class="section">
                <h2 class="section-title">Languages &amp; Tools</h2>

                <div class="technical" style="margin-top: 6px;">
                    <div class="editable"><strong>Languages:</strong> English (Fluent) | Spanish (Native)</div>
                </div>
                <div class="technical" style="margin-top: 8px;">
                    <div class="editable"><strong>CRM / Ticketing:</strong> Salesforce ‚Ä¢ Customer Access Tool</div>
                </div>
                <div class="technical" style="margin-top: 8px;">
                    <div class="editable"><strong>Banking Systems:</strong> FDR ‚Ä¢ AS/400</div>
                </div>
                <div class="technical" style="margin-top: 8px;">
                    <div class="editable"><strong>Data &amp; Reporting:</strong> Excel (Advanced) ‚Ä¢ PowerPoint ‚Ä¢ SQL ‚Ä¢ HTML ‚Ä¢ CSS</div>
                </div>
                <div class="technical" style="margin-top: 8px;">
                    <div class="editable"><strong>Automation / AI:</strong> AI Prompt Engineering (process documentation, reporting, analysis)</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // -----------------------
        // Utilities
        // -----------------------
        const toast = document.getElementById('toast');
        function showToast(message, kind = 'info') {
            const bg = kind === 'error' ? '#b91c1c' : kind === 'warn' ? '#b45309' : '#1f2937';
            toast.style.background = bg;
            toast.textContent = message;
            toast.style.display = 'block';
            clearTimeout(showToast._t);
            showToast._t = setTimeout(() => (toast.style.display = 'none'), 4200);
        }

        function safeDisable(btn, text) {
            btn.dataset._orig = btn.textContent;
            btn.textContent = text;
            btn.disabled = true;
        }

        function safeEnable(btn) {
            btn.textContent = btn.dataset._orig || btn.textContent;
            btn.disabled = false;
        }

        // -----------------------
        // Edit Mode
        // -----------------------
        let editMode = false;
        const editBtn = document.getElementById('editBtn');
        const editInstructions = document.getElementById('editInstructions');
        const mainContainer = document.querySelector('.container');

        editBtn.addEventListener('click', () => {
            editMode = !editMode;

            if (editMode) {
                mainContainer.classList.add('edit-mode');
                editInstructions.classList.add('show');
                editBtn.classList.add('active');
                editBtn.textContent = 'üíæ Save Changes';

                document.querySelectorAll('.editable').forEach(el => el.setAttribute('contenteditable', 'true'));
            } else {
                mainContainer.classList.remove('edit-mode');
                editInstructions.classList.remove('show');
                editBtn.classList.remove('active');
                editBtn.textContent = '‚úèÔ∏è Edit Mode';

                document.querySelectorAll('.editable').forEach(el => el.removeAttribute('contenteditable'));
            }
        });

        // -----------------------
        // Export: PDF (Print -> Save as PDF)
        // -----------------------
        const pdfBtn = document.getElementById('pdfBtn');

        // -----------------------
        // Theme Switcher
        // -----------------------
        const themeSelect = document.getElementById('themeSelect');
        const THEME_KEY = 'cv_theme_v1';

        function applyTheme(theme) {
            const t = theme || 'classic';
            document.body.dataset.theme = t;
            try { localStorage.setItem(THEME_KEY, t); } catch (_) {}
        }

        (function initTheme() {
            let saved = 'classic';
            try { saved = localStorage.getItem(THEME_KEY) || 'classic'; } catch (_) {}
            applyTheme(saved);
            if (themeSelect) themeSelect.value = saved;
            if (themeSelect) {
                themeSelect.addEventListener('change', (e) => applyTheme(e.target.value));
            }
        })();

        function buildPrintableHTML() {
            const clone = mainContainer.cloneNode(true);

            clone.classList.remove('edit-mode');
            clone.querySelectorAll('[contenteditable]').forEach(el => el.removeAttribute('contenteditable'));

            // Remove interactive-only styles (optional)
            clone.querySelectorAll('.editable').forEach(el => el.classList.remove('editable'));

            // Copy CSS from the main style tag
            const css = document.querySelector('style') ? document.querySelector('style').innerHTML : '';

            return `<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Resume - Ilich Vasquez</title>
<style>
@page { size: letter; margin: 0.4in; }
html, body { background: #ffffff !important; }
.container { box-shadow: none !important; }
${css}
</style>
</head>
<body data-theme="${document.body.dataset.theme || 'classic'}">
${clone.outerHTML}
</body>
</html>`;
        }

        function exportPdfViaPrint() {
            const html = buildPrintableHTML();

            // Use a hidden iframe to avoid popup blockers
            const iframe = document.createElement('iframe');
            iframe.style.position = 'fixed';
            iframe.style.right = '0';
            iframe.style.bottom = '0';
            iframe.style.width = '0';
            iframe.style.height = '0';
            iframe.style.border = '0';
            iframe.setAttribute('aria-hidden', 'true');
            document.body.appendChild(iframe);

            const doc = iframe.contentDocument || iframe.contentWindow.document;
            doc.open();
            doc.write(html);
            doc.close();

            const doPrint = () => {
                try {
                    iframe.contentWindow.focus();
                    iframe.contentWindow.print();
                } finally {
                    // Cleanup after the print dialog opens
                    setTimeout(() => {
                        if (iframe && iframe.parentNode) iframe.parentNode.removeChild(iframe);
                    }, 1000);
                }
            };

            // Some browsers won't fire iframe.onload reliably after document.write
            iframe.onload = doPrint;
            setTimeout(doPrint, 350);
        }

        pdfBtn.addEventListener('click', () => {
            safeDisable(pdfBtn, '‚è≥ Opening Print...');
            try {
                // In many sandboxes, true programmatic PDF download is restricted.
                // Print -> Save as PDF is the most reliable path.
                exportPdfViaPrint();
            } finally {
                setTimeout(() => safeEnable(pdfBtn), 600);
            }
        });

        // -----------------------
        // Export: Word (.doc HTML)
        // -----------------------
        const wordBtn = document.getElementById('wordBtn');

        function buildWordHTML() {
            const clone = mainContainer.cloneNode(true);

            clone.classList.remove('edit-mode');
            clone.querySelectorAll('[contenteditable]').forEach(el => el.removeAttribute('contenteditable'));
            clone.querySelectorAll('.editable').forEach(el => el.classList.remove('editable'));

            const content = clone.innerHTML;

            // Note: Many Word versions accept HTML packaged as .doc.
            return `<!DOCTYPE html>
<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'>
<head>
<meta charset='UTF-8'>
<xml>
<w:WordDocument>
<w:View>Print</w:View>
<w:Zoom>100</w:Zoom>
</w:WordDocument>
</xml>
<style>
body { font-family: Calibri, 'Segoe UI', sans-serif; line-height: 1.6; margin: 0; padding: 0; }
.header { background: #1e3a8a; color: #fff !important; padding: 40px; text-align: center; margin-bottom: 20px; }
h1 { font-size: 42px; font-weight: 700; margin: 0 0 10px 0; letter-spacing: 2px; color: #fff !important; }
.contact-info { text-align: center; margin-top: 15px; font-size: 14px; color: #fff !important; }
.contact-info span { margin: 0 10px; color: #fff !important; }
.content { padding: 40px; }
.section { margin-bottom: 30px; }
.section-title { font-size: 20px; font-weight: 700; color: #1e3a8a !important; border-bottom: 3px solid #3b82f6; padding-bottom: 8px; margin-bottom: 15px; text-transform: uppercase; letter-spacing: 1px; }
.summary { font-size: 15px; color: #374151; line-height: 1.8; text-align: justify; margin-bottom: 15px; }
.skill-category h4 { color: #1e3a8a; font-size: 14px; margin: 5px 0; font-weight: 600; }
.skill-category p { color: #6b7280; font-size: 13px; line-height: 1.6; margin: 0; }
.job { margin-bottom: 25px; }
.job-title { font-size: 16px; font-weight: 700; color: #1e3a8a; margin-bottom: 3px; }
.job-date { font-size: 13px; color: #6b7280; font-weight: 600; }
.company { font-size: 14px; color: #374151; font-weight: 600; margin-bottom: 8px; }
.achievements { list-style: none; padding-left: 0; margin: 0; }
.achievements li { padding-left: 20px; margin-bottom: 6px; position: relative; font-size: 13px; color: #4b5563; line-height: 1.7; }
.achievements li:before { content: "‚ñ∏"; position: absolute; left: 0; color: #3b82f6; font-weight: bold; }
strong { color: #1e3a8a !important; font-weight: 600; }
.education-item h4 { font-size: 14px; color: #1e3a8a; margin: 3px 0; }
.education-item p { font-size: 13px; color: #6b7280; margin: 2px 0; }
.cert-item { font-size: 13px; color: #4b5563; padding-left: 15px; position: relative; margin-bottom: 5px; }
.cert-item:before { content: "‚úì"; position: absolute; left: 0; color: #3b82f6; font-weight: bold; }
.languages, .technical { font-size: 14px; margin-bottom: 5px; }
</style>
</head>
<body>
${content}
</body>
</html>`;
        }

        function exportWordDoc(filename = 'Ilich_Vasquez_Resume.doc') {
            const wordHTML = buildWordHTML();
            const blob = new Blob(['\ufeff', wordHTML], { type: 'application/msword;charset=utf-8' });

            // IE / legacy
            if (window.navigator && window.navigator.msSaveOrOpenBlob) {
                window.navigator.msSaveOrOpenBlob(blob, filename);
                return;
            }

            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);

            showToast('Downloading Word file‚Ä¶ If it does not start, check your browser\'s blocked downloads icon and allow downloads for this site.', 'info');

            setTimeout(() => URL.revokeObjectURL(url), 15000);
        }

        wordBtn.addEventListener('click', () => {
            safeDisable(wordBtn, '‚è≥ Preparing...');
            try {
                exportWordDoc('Ilich_Vasquez_Resume.doc');
            } catch (e) {
                console.error(e);
                showToast('Word export failed. Check popup/download settings.', 'error');
            } finally {
                setTimeout(() => safeEnable(wordBtn), 600);
            }
        });

        // -----------------------
        // Minimal self-tests (console)
        // -----------------------
        function assert(condition, message) {
            if (!condition) throw new Error(message);
        }

        function runTests() {
            const results = [];
            try {
                assert(!!document.getElementById('editBtn'), 'Missing editBtn');
                assert(!!document.getElementById('pdfBtn'), 'Missing pdfBtn');
                assert(!!document.getElementById('wordBtn'), 'Missing wordBtn');
                const p = buildPrintableHTML();
                const w = buildWordHTML();
                assert(typeof p === 'string' && p.includes('<!DOCTYPE html>'), 'Printable HTML not built');
                assert(typeof w === 'string' && w.includes('<w:WordDocument>'), 'Word HTML not built');
                results.push('‚úÖ Tests passed');
            } catch (err) {
                console.error(err);
                results.push('‚ùå Tests failed: ' + err.message);
            }
            console.log(results.join('\n'));
        }

        // Run tests after DOM is ready
        window.addEventListener('DOMContentLoaded', runTests);
    </script>
</body>
</html>
